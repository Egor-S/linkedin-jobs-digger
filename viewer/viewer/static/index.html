<html lang="en">
<head>
    <title>LI Jobs Digger</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        #app {
            display: flex;
            width: 100%;
            height: 100%;
        }
        .jobs-list {
            min-width: 400px;
            overflow-y: scroll;
        }
        .view-pane {
            overflow-y: scroll;
        }
        .job-card {
            margin: 5px;
            padding: 2px;
            background-color: #efefef;
        }
        .job-card.active {
            background-color: #e3f4ff;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="jobs-list">
            <div v-for="job in jobs" class="job-card" :class="{active: job.id === activeJob?.id}" :key="job.id" @click="getJobDescription(job.id)">
                <ul>
                    <li><a :href="getJobURL(job.id)" target="_blank">{{ job.title }}</a></li>
                    <li>{{ job.company }}</li>
                    <li>{{ job.location }}</li>
                    <li>{{ job.date }}</li>
                </ul>
            </div>
        </div>
        <div class="view-pane">
            <div v-html="activeJob?.description?.text"></div>
        </div>
    </div>
    <script>
        const { createApp } = Vue
        createApp({
            data() {
                return {
                    jobs: [],
                    activeJob: undefined
                }
            },
            methods: {
                async getJobsList() {
                    this.jobs = await fetch("/api/jobs").then(d => d.json())
                },
                async getJobDescription(job_id) {
                    this.activeJob = await fetch(`/api/jobs/${job_id}`).then(d => d.json())
                },
                getJobURL(job_id) {
                    return `https://www.linkedin.com/jobs/view/${job_id}/`
                }
            },
            mounted() {
                this.getJobsList()
            }
        }).mount('#app')
    </script>
</body>
</html>
